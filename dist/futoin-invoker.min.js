!function(r){"function"==typeof define&&define.amd?define(["futoin-asyncsteps"],r):"object"==typeof exports?module.exports=r(require("futoin-asyncsteps")):this.FutoInInvoker=r($as)}(function(r){function e(r){var t=e.cache[r];if(!t){var n={};t=e.cache[r]={id:r,exports:n},e.modules[r].call(n,t,n)}return t.exports}var t=this;return e.cache=[],e.modules=[function(r,t){"use strict";function n(r){f(this),this._iface_info={},this._iface_impl={},this._impl=new c(r)}var o=e(150),i=e(9),s=i.FutoInError,a=e(156),c=e(5),u=e(3),f=e(26);a(n,i.Options);var p=o(u.prototype);n.prototype=p,p.initFromCache=function(r,e){r.error(s.NotImplemented,"Caching is not supported yet")},p.cacheInit=function(r){},r.exports=n},function(r,e){"use strict";function t(r){this._raw_info=r}var n={};t.prototype=n,n.name=function(){return this._raw_info.iface},n.version=function(){return this._raw_info.version},n.inherits=function(){return this._raw_info.inherits},n.funcs=function(){return this._raw_info.funcs},n.constraints=function(){return this._raw_info.constraints},r.exports=t},function(r,t){"use strict";function n(r,e){this._ccmimpl=r,this._raw_info=e,this._iface_info=null,this._comms={},a(this);for(var t in this._raw_info.funcs){var n=this._raw_info.funcs[t];n.rawupload||(t in this||(this[t]=this._member_call_generate(t,n)))}}var o=e(9),i=o.FutoInError,s=e(172),a=e(26),c=e(27),u=e(1),f=o.Options.FUTOIN_CONTENT_TYPE,p={};n.prototype=p,p.call=function(r,e,t,n,o,s){t=t||{};var a=this._raw_info,u={ccmimpl:this._ccmimpl,name:e,info:a,upload_data:n,download_stream:o,rsp_content_type:null,native_iface:this,options:a.options,endpoint:a.endpoint,expect_response:!0,signMessage:this._signMessageDummy},p=this._ccmimpl;r.add(function(r){p.createMessage(r,u,t)}),r.add(function(r,t){var l;u.expect_response?(l=r,"number"!=typeof s&&(s=u.info.options.callTimeoutMS),s>0&&l.setTimeout(s)):l=c();var v=a.endpoint_scheme;if("#internal#"===v)u.endpoint.onInternalRequest(l,a,t,n,o);else if("http"===v||"https"===v)p.perfomHTTP(l,u,t);else if("ws"===v||"wss"===v){var h,_=u.download_stream||u.info.funcs&&(h=u.info.funcs[e])&&h.rawresult;u.upload_data||_?(u.endpoint=u.endpoint.replace("ws","http"),u.rawresult=_,p.perfomHTTP(l,u,t)):p.perfomWebSocket(l,u,t)}else u.upload_data?l.error(i.InvokerError,"Upload data is allowed only for HTTP/WS endpoints"):u.download_stream?l.error(i.InvokerError,"Download stream is allowed only for HTTP/WS endpoints"):"browser"===v?p.perfomBrowser(l,u,t):"unix"===v?p.perfomUNIX(l,u,t):"callback"===v?u.endpoint(l,u,t):l.error(i.InvokerError,"Unknown endpoint scheme");l!==r?(l.execute(),r.success()):l.add(function(r,e,t){if(u.download_stream)r.success(!0);else if(t===f||!0===t){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){r.error(i.CommError,"JSON:"+e.message)}p.onMessageResponse(r,u,e)}else p.onDataResponse(r,u,e)})})},p._member_call_intercept=function(r,e,t,n){var o=t.params,a=Object.keys(o);n.length>a.length?r.error(i.InvokerError,"Unknown parameters"):n.length<t.min_args?r.error(i.InvokerError,"Missing parameters"):n.length<a.length&&(a=a.splice(0,n.length));var c=s(a,n);this.call(r,e,c)},p._member_call_generate=function(r,e){return function(t){this._member_call_intercept(t,r,e,Array.prototype.slice.call(arguments,1))}},p.ifaceInfo=function(){return this._iface_info||(this._iface_info=new u(this._raw_info)),this._iface_info},p.bindDerivedKey=function(r){throw new Error(i.InvokerError,"Not Implemented")},p._close=function(){var r=this._comms;for(var e in r)r[e].close();this.emit("close")},p._signMessageDummy=function(){},r.exports=n},function(r,t){"use strict";function n(r){f(this),this._iface_info={},this._iface_impl={},this._impl=new u(r)}var o=e(9),i=o.FutoInError,s=e(2),a=e(156),c=e(153),u=e(6),f=e(26),p=o.Options;a(n,p);var l={};n.prototype=l,a(l,p),l._secure_replace=/^secure\+/,l._secure_test=/^(https|wss|unix):\/\//,l._native_iface_builder=function(r,e){return new s(r,e)},l.register=function(r,e,t,n,s,a){var u=null===e;!u&&e in this._iface_info&&r.error(i.InvokerError,"Already registered");var f=t.match(o._ifacever_pattern);null===f&&r.error(i.InvokerError,"Invalid ifacever");var p,l=f[1],v=f[4],h=f[5],_=f[6],d=!1,m=null,y=!1;if(u)p="callback",y=!0;else if("string"==typeof n)switch(this._secure_replace.test(n)?(d=!0,n=n.replace(this._secure_replace,"")):this._secure_test.test(n)&&(d=!0),m=this._native_iface_builder,p=n.split(":")[0]){case"http":case"https":break;case"ws":case"wss":case"unix":y=!0;break;case"browser":a&&a.targetOrigin&&(d=!0),y=!0;break;default:r.error(i.InvokerError,"Unknown endpoint schema")}else"onInternalRequest"in n?(d=!0,m=this._native_iface_builder,p="#internal#",y=!0):(d=!0,m=n,n=null,p=null,y=!0);c(a=a||{},this._impl.options);var g={iface:l,version:v,mjrver:h,mnrver:_,endpoint:n,endpoint_scheme:p,creds:s||null,creds_master:"master"===s,creds_hmac:s&&"-hmac:"===s.substr(0,6),secure_channel:d,impl:m,regname:e,inherits:null,funcs:null,constraints:null,options:a,_invoker_use:!0,_user_info:null};!g.creds_hmac||a.hmacKey&&a.hmacAlgo||r.error(i.InvokerError,"Missing options.hmacKey or options.hmacAlgo"),e&&(this._iface_info[e]=g);var b=this;r.add(function(r){b._impl.onRegister(r,g),r.add(function(r){g.simple_req||("AllowAnonymous"in g.constraints||g.creds||r.error(i.SecurityError,"Requires authenticated user"),"SecureChannel"in g.constraints&&!d&&r.error(i.SecurityError,"SecureChannel is required"),"MessageSignature"in g.constraints&&!g.creds_master&&!g.creds_hmac&&r.error(i.SecurityError,"SecureChannel is required"),"BiDirectChannel"in g.constraints&&!y&&r.error(i.InvokerError,"BiDirectChannel is required")),u&&r.success(g,b._native_iface_builder(b._impl,g)),b.emit("register",e,t,g)})},function(r,t){e&&delete b._iface_info[e]})},l.iface=function(r){var e=this._iface_info[r];if(!e)throw new Error(i.InvokerError);var t=e.regname,n=this._iface_impl[t];if(!n){var o=e.options.nativeImpl;n=o?new o(this._impl,e):e.impl(this._impl,e),this._iface_impl[t]=n}return n},l.unRegister=function(r){var e=this._iface_info[r];if(!e)throw new Error(i.InvokerError);var t=e.regname;if(t===r){delete this._iface_info[t];var n=this._iface_impl[t];if(n&&(n._close(),delete this._iface_impl[t]),e.aliases)for(var o=e.aliases,s=0;s<o.length;++s)delete this._iface_info[o[s]]}else delete this._iface_info[r],e.aliases.splice(e.aliases.indexOf(r),0);this.emit("unregister",r,e)},l.defense=function(){return this.iface(this.SVC_DEFENSE)},l.log=function(){return this.iface(this.SVC_LOG)},l.cache=function(r){return this.iface(this.SVC_CACHE_+(r||"default"))},l.assertIface=function(r,e){var t=this._iface_info[r];if(!t)throw new Error(i.InvokerError);var n=e.match(o._ifacever_pattern);if(null===n)throw new Error(i.InvokerError);var s=n[1],a=n[5],c=n[6];if(t.iface!==s||t.mjrver!==a||t.mnrver<c)throw new Error(i.InvokerError)},l.alias=function(r,e){var t=this._iface_info[r];if(!t||this._iface_info[e])throw new Error(i.InvokerError);this._iface_info[e]=t,t.aliases?t.aliases.push(e):t.aliases=[e],this.emit("register",e,t.iface+":"+t.version,t)},l.close=function(){var r=this._iface_impl;for(var e in r)r[e]._close();var t=this._impl.comms;for(var n in t)t[n].close();this.emit("close")},r.exports=n},function(r,t){"use strict";var n,o,i=e(9),s=i.FutoInError,a=e(12),c=e(151),u=e(172),f=e(154),p=e(156);if(a){var l=require;n=l("fs"),o=l("request")}var v={standard_errors:{UnknownInterface:!0,NotSupportedVersion:!0,NotImplemented:!0,Unauthorized:!0,InternalError:!0,InvalidRequest:!0,DefenseRejected:!0,PleaseReauth:!0,SecurityError:!0},_ver_pattern:/^([0-9]+)\.([0-9]+)$/,_ifacever_pattern:i._ifacever_pattern,_max_supported_v1_minor:6,loadIface:function(r,e,t,i){var c,u,f=null,l=e.iface+"-"+e.version+"-iface.json";if(i){if(u=e.iface+":"+e.version,e._import_use?u+=":r":e._invoker_use?u+=":i":u+=":e",c=i[u])return void p(e,c);c={_import_use:e._import_use,_invoker_use:e._invoker_use}}else c=e;r.forEach(t,function(r,t,i){r.add(function(r){if("string"==typeof i&&a){var e=i+"/"+l,t=function(e){if(r){try{return i=JSON.parse(e),i._just_loaded=!0,void r.success()}catch(r){}try{r.continue()}catch(r){}}};"http"===e.substr(0,4)?o(e,function(r,e,n){t(n)}):n.readFile(e,{encoding:"utf8"},function(r,e){t(e)}),r.setCancel(function(e){r=null})}}).add(function(r){if("string"==typeof i&&!a){var e=i+"/"+l,t=new XMLHttpRequest;t.onreadystatechange=function(){if(this.readyState===this.DONE){var e=this.responseText;if(e)try{return i=JSON.parse(e),i._just_loaded=!0,void r.success()}catch(r){}try{r.continue()}catch(r){}}},t.open("GET",e,!0),t.send(),r.setCancel(function(r){t.abort()})}}).add(function(r){"object"==typeof i&&i.iface===e.iface&&i.version===e.version&&(f=i,r.break())})}).add(function(r){null===f&&r.error(s.InternalError,"Failed to load valid spec for "+e.iface+":"+e.version),v.parseIface(r,c,t,f,i)}),i&&r.add(function(r){i[u]=c,p(e,c)})},parseIface:function(r,e,t,n,o){if(n._just_loaded?(e.funcs=n.funcs||{},e.types=n.types||{}):(e.funcs=c(n.funcs||{}),e.types=c(n.types||{})),v._parseFuncs(r,e),v._parseTypes(r,e),"requires"in n){var a=n.requires;Array.isArray(a)||r.error(s.InternalError,'"requires" is not array'),e.constraints=u(a,a)}else e.constraints={};if(v._checkFTN3Rev(r,e,n),e.inherits=[],"inherit"in n){var f=n.inherit.match(i._ifacever_pattern);null===f&&r.error(s.InvokerError,"Invalid inherit ifacever: "+n.inherit);var p={};p.iface=f[1],p.version=f[4],p._invoker_use=e._invoker_use,v.loadIface(r,p,t,o),r.add(function(r){v._parseImportInherit(r,e,t,n,p),e.inherits.push(n.inherit),e.inherits=e.inherits.concat(p.inherits)})}if("imports"in n){var l=i._ifacever_pattern,h=o||{};e.imports=n.imports.slice(),r.forEach(n.imports,function(r,n,o){var i=o.match(l);null===i&&r.error(s.InvokerError,"Invalid import ifacever: "+o);var a={};a.iface=i[1],a.version=i[4],a._import_use=!0,v.loadIface(r,a,t,h),r.add(function(r){e.imports=e.imports.concat(a.imports)})}),e._import_use||r.add(function(r){for(var o={},i=e.imports.length-1;i>=0;--i){var a=e.imports[i].match(l),c=a[1],u=a[4],f=o[c];if(f){f=f.split(".");var p=u.split(".");f[0]!==p[0]&&r.error(s.InvokerError,"Incompatible iface versions: "+c+" "+u+"/"+o[c]),parseInt(f[1])<parseInt(p[1])&&(o[c]=u)}else o[c]=u}e.imports=[],r.forEach(o,function(r,o,i){e.imports.push(o+":"+i);var s={};s.iface=o,s.version=i,s._import_use=!0,v.loadIface(r,s,t,h),r.add(function(r){v._parseImportInherit(r,e,t,n,s)})})})}else e.imports=[]},_checkFTN3Rev:function(r,e,t){var n=(t.ftn3rev||"1.0").match(v._ver_pattern);null===n&&r.error(s.InternalError,"Invalid ftn3rev field");var o=parseInt(n[1]),i=parseInt(n[2]);if(1===o){if(i<1&&(t.imports||t.types||"BiDirectChannel"in e.constraints)&&r.error(s.InternalError,"Missing ftn3rev or wrong field for FTN3 v1.1 features"),i<2&&"MessageSignature"in e.constraints&&r.error(s.InternalError,"Missing ftn3rev or wrong field for FTN3 v1.2 features"),i<3)for(var a in e.funcs)e.funcs[a].seclvl&&r.error(s.InternalError,"Missing ftn3rev or wrong field for FTN3 v1.3 features");!e._invoker_use&&i>v._max_supported_v1_minor&&r.error(s.InternalError,"Not supported FTN3 revision for Executor")}else r.error(s.InternalError,"Not supported FTN3 revision")},_parseFuncs:function(r,e){var t,n;for(var o in e.funcs){if(t=e.funcs[o],t.min_args=0,"params"in t){var i=t.params;"object"!=typeof i&&r.error(s.InternalError,"Invalid params object");for(n in i){var a=i[n];"string"==typeof a?t.min_args+=1:("object"!=typeof a&&r.error(s.InternalError,"Invalid param object"),"type"in a||r.error(s.InternalError,"Missing type for params"),"default"in a||(t.min_args+=1))}}else t.params={};if(t.expect_result=!1,"result"in t){var c=t.result;"object"!=typeof c&&r.error(s.InternalError,"Invalid result object");for(var f in c){var p=c[f];"string"!=typeof p&&("object"!=typeof p&&r.error(s.InternalError,"Invalid resultvar object"),"type"in p||r.error(s.InternalError,"Missing type for result")),t.expect_result=!0}}else t.result={};if("rawupload"in t||(t.rawupload=!1),"rawresult"in t||(t.rawresult=!1),t.rawresult&&(t.expect_result=!0),"throws"in t){t.expect_result||r.error(s.InternalError,'"throws" without result');var l=t.throws;Array.isArray(l)||r.error(s.InternalError,'"throws" is not array'),t.throws=u(l,l)}else t.throws={}}},_parseTypes:function(r,e){var t;for(var n in e.types)if("string"!=typeof(t=e.types[n])&&!(t instanceof Array)&&("type"in t||r.error(s.InternalError,'Missing "type" for custom type'),"map"===t.type)){if(!("fields"in t)){t.fields={};continue}for(var o in t.fields){var i=t.fields[o];"string"==typeof i||i instanceof Array||"type"in i||r.error(s.InternalError,'Missing "type" for custom type field')}}},_parseImportInherit:function(r,e,t,n,o){var i,a;for(var c in o.types)c in e.types?r.error(s.InternalError,"Iface type redifintion: "+c):e.types[c]=o.types[c];for(var u in o.funcs){var p=o.funcs[u];if(u in e.funcs){var l=p.params,v=e.funcs[u].params,h=Object.keys(l),_=Object.keys(v);for(_.length<h.length&&r.error(s.InternalError,"Invalid param count for '"+u+"'"),i=0;i<h.length;++i)(a=h[i])!==_[i]&&r.error(s.InternalError,"Invalid param order for '"+u+"/"+a+"'"),l[a].type!==v[a].type&&r.error(s.InternalError,"Param type mismatch '"+u+"/"+a+"'");for(;i<_.length;++i)(a=_[i])in l||"default"in v[a]||null===v[a]||r.error(s.InternalError,"Missing default for '"+u+"/"+a+"'");p.rawresult!==e.funcs[u].rawresult&&r.error(s.InternalError,"'rawresult' flag mismatch for '"+u+"'"),p.seclvl!==e.funcs[u].seclvl&&r.error(s.InternalError,"'seclvl' mismatch for '"+u+"'"),p.rawupload&&!e.funcs[u].rawupload&&r.error(s.InternalError,"'rawupload' flag is missing for '"+u+"'")}else e.funcs[u]=p}f(Object.keys(o.constraints),n.requires).length&&r.error(s.InternalError,"Missing constraints from inherited")},checkConsistency:function(r,e){},checkType:function(r,e,t,n){if(null===t)return!1;switch(e){case"any":return!0;case"boolean":case"string":case"number":return typeof t===e;case"map":return"object"==typeof t&&!(t instanceof Array);case"integer":return"number"==typeof t&&(0|t)===t;case"array":return t instanceof Array;case"enum":case"set":return n?"enum"===e||t instanceof Array:(console.log("[ERROR] enum and set are allowed only in custom types"),!1);default:if(!("types"in r&&e in r.types))return!1}if(e in r.types){var o=r.types[e];("string"==typeof o||o instanceof Array)&&(o={type:o});var i=!n;if(n=n||{},e in n)throw console&&console.log("[ERROR] Custom type recursion: "+o.type),new Error(s.InternalError);n[e]=!0;var a=o.type;if(a instanceof Array){n["#last_base"]=null,console.log(a);for(var c=a.length-1;c>=0;--c){var f=a[c],l=Object.create(n);if(l["#last_base"]=f,this.checkType(r,f,t,l)){p(n,l);break}}if(!n["#last_base"])return!1}else if(n["#last_base"]=a,!this.checkType(r,a,t,n))return!1;if(a=n["#last_base"],o=p(n["#tdef"]||{},o),!i)return n["#tdef"]=o,!0;var v;switch(a){case"integer":case"number":return!("min"in o&&t<o.min)&&!("max"in o&&t>o.max);case"string":if("regex"in o){var h;if("_comp_regex"in r?h=r._comp_regex:(h={},r._comp_regex=h),e in h||(h[e]=new RegExp(o.regex)),null===t.match(h[e]))return!1}return!("minlen"in o&&t.length<o.minlen)&&!("maxlen"in o&&t.length>o.maxlen);case"array":var _=t.length;if("minlen"in o&&_<o.minlen)return!1;if("maxlen"in o&&_>o.maxlen)return!1;if("elemtype"in o){v=o.elemtype;for(var d=0;d<_;++d)if(!this.checkType(r,v,t[d],null))return!1}return!0;case"map":if(!("fields"in o))return!0;var m=o.fields;for(var y in m){var g=m[y];if("string"==typeof g&&(g={type:g}),!(y in t)||null===t[y])return!!g.optional&&(t[y]=null,!0);if(!this.checkType(r,g.type,t[y],null))return!1}if("elemtype"in o){v=o.elemtype;for(var b in t)if(!this.checkType(r,v,t[b],null))return!1}return!0;case"enum":case"set":var x,w;if("_comp_set"in r?x=r._comp_set:(x={},r._comp_set=x),e in x)w=x[e];else{if(void 0===(w=o.items))return!1;w=u(w,w),x[e]=w}"enum"===a&&(t=[t]);for(var j=t.length-1;j>=0;--j){var I=t[j];if(!this.checkType(r,"string",I)&&!this.checkType(r,"integer",I)||!w.hasOwnProperty(t[j]))return!1}return!0}}return!1},checkParameterType:function(r,e,t,n){var o=r.funcs[e].params[t];if(null===n&&null===o.default)return!0;var i="string"==typeof o?o:o.type;return v.checkType(r,i,n)},checkResultType:function(r,e,t,n,o){var i=e.funcs[t].result[n],a="string"==typeof i?i:i.type;v.checkType(e,a,o)||r.error(s.InvalidRequest,"Type mismatch for result: "+n)},checkFutoInType:function(r,e,t,n){v.checkType({},e,n)||r.error(s.InvalidRequest,"Type mismatch for parameter: "+t)},genHMAC:function(r,e,t){r.error(s.InvalidRequest,"HMAC generation is supported only for server environment")}};a&&l("./lib/node/spectools_hmac")(v),r.exports=v},function(r,t){"use strict";function n(r){a(r=r||{},c);var e=r.specDirs||[];e instanceof Array||(e=[e]),r.specDirs=e,i.call(this,r),this._load_cache={}}var o=e(9).FutoInError,i=e(6),s=e(4),a=e(153),c={specDirs:[],hmacKey:null,hmacAlgo:"MD5",sendOnBehalfOf:!0},u=i.prototype;n.prototype={onRegister:function(r,e){!e.creds_master&&!e.creds_hmac||s.checkHMAC||r.error(o.InvokerError,"Master/HMAC is not supported in this environment yet"),s.loadIface(r,e,e.options.specDirs,this._load_cache),e.options.prodMode||s.checkConsistency(r,e)},checkParams:function(r,e,t){var n,i=e.info,a=e.name;a in i.funcs||r.error(o.InvokerError,"Unknown interface function: "+a);var c=i.funcs[a];e.upload_data&&!c.rawupload&&r.error(o.InvokerError,"Raw upload is not allowed"),!Object.keys(c.params).length&&Object.keys(t).length&&r.error(o.InvokerError,"No params are defined");for(n in t)c.params.hasOwnProperty(n)||r.error(o.InvokerError,"Unknown parameter: "+n),s.checkParameterType(i,a,n,t[n])||r.error(o.InvalidRequest,"Type mismatch for parameter: "+n);for(n in c.params)t.hasOwnProperty(n)||c.params[n].hasOwnProperty("default")||r.error(o.InvokerError,"Missing parameter "+n)},createMessage:function(r,e,t){var n=e.info,i=n.options;i.prodMode||this.checkParams(r,e,t);var a={f:n.iface+":"+n.version+":"+e.name,p:t};if(i.sendOnBehalfOf){var c=r.state.reqinfo;if(c){var u=c.info,f=u.USER_INFO;a.obf=f?{lid:f.localID(),gid:f.globalID(),slvl:u.SECURITY_LEVEL}:{slvl:"Anonymous"}}}e.expect_response=n.funcs[e.name].expect_result,null!==n.creds&&(n.creds_master?(r.error(o.InvokerError,"MasterService support is not implemented"),e.signMessage=function(r){}):n.creds_hmac?e.signMessage=function(e){e.sec=n.creds+":"+i.hmacAlgo+":"+s.genHMAC(r,n.options,e).toString("base64")}:a.sec=n.creds),r.success(a)},onMessageResponse:function(r,e,t){var n=e.info,i=e.name,a=n.funcs[i];if(n.creds_master)r.error(o.InvokerError,"MasterService support is not implemented");else if(n.creds_hmac){var c;try{c=new Buffer(t.sec,"base64")}catch(f){r.error(o.SecurityError,"Missing response HMAC")}delete t.sec;var u=s.genHMAC(r,n.options,t);s.checkHMAC(c,u)||r.error(o.SecurityError,"Response HMAC mismatch")}if("e"in t){var f=t.e;f in a.throws||f in s.standard_errors?r.error(f,t.edesc):r.error(o.InternalError,"Not expected exception from Executor")}a.rawresult&&r.error(o.InternalError,"Raw result is expected"),n.creds;var p=a.result,l=Object.keys(p).length;for(var v in t.r)p.hasOwnProperty(v)&&(s.checkResultType(r,n,i,v,t.r[v]),--l);l>0&&r.error(o.InternalError,"Missing result variables"),r.success(t.r)},onDataResponse:function(r,e,t){e.info.funcs[e.name].rawresult?r.success(t):r.error(o.InternalError,"Raw result is not expected")},getComms:u.getComms,performCommon:u.performCommon,perfomHTTP:u.perfomHTTP,perfomWebSocket:u.perfomWebSocket,perfomUNIX:u.perfomUNIX,perfomBrowser:u.perfomBrowser},r.exports=n},function(r,t){"use strict";function n(r){a(r=r||{},u),this.options=r,this.comms={}}var o,i=e(9).FutoInError,s=e(12),a=e(153);if(s){var c=require;o=c("./node/comms")}else o=e(8);var u={callTimeoutMS:3e4,prodMode:!1,commConfigCallback:null,messageSniffer:function(){},disconnectSniffer:function(){},executor:null,targetOrigin:null,retryCount:1};n.prototype={onRegister:function(r,e){(e.creds_master||e.creds_hmac)&&r.error(i.InvokerError,"Master/HMAC is supported only in AdvancedCCM"),e.funcs={},e.inherits=[],e.constraints={},e.simple_req=!0},createMessage:function(r,e,t){var n=e.info,o={f:n.iface+":"+n.version+":"+e.name,p:t,forcersp:!0};null!==n.creds&&"master"!==n.creds&&(o.sec=n.creds),r.success(o)},onMessageResponse:function(r,e,t){"e"in t?r.error(t.e,t.edesc):r.success(t.r)},onDataResponse:function(r,e,t){r.success(t)},getComms:function(r,e,t,n){var o,s,a=e.options,c=this.options;a.executor!==c.executor||a.messageSniffer!==c.messageSniffer||a.disconnectSniffer!==c.disconnectSniffer||a.commConfigCallback!==c.commConfigCallback?(o=e.native_iface._comms,s=e.info.endpoint_scheme):(o=this.comms,s=e.endpoint+"##"+(e.credentials||"")+"##"+(n||""));var u=o[s];return u||(t||r.error(i.InvokerError,"Not implemented "+e.info.endpoint_scheme+" scheme"),u=new t,o[s]=u),u},performCommon:function(r,e,t,n){var o,s,a=e.options.retryCount;r.repeat(a+1,function(r,c){r.add(function(r){n.perform(r,e,t),r.add(function(r,e,t){o=e,s=t,r.break()})},function(r,n){n===i.CommError&&(e.native_iface.emit("commError",r.state.error_info,t),c<a&&r.continue())})}).add(function(r){r.success(o,s)})},perfomHTTP:function(r,e,t){var n=this.getComms(r,e,o.HTTPComms);this.performCommon(r,e,t,n)},perfomWebSocket:function(r,e,t){var n=this.getComms(r,e,o.WSComms);this.performCommon(r,e,t,n)},perfomUNIX:function(r,e,t){r.error(i.InvokerError,"Not implemented unix:// scheme")},perfomBrowser:function(r,e,t){this.getComms(r,e,o.BrowserComms,e.options.targetOrigin).perform(r,e,t)}},r.exports=n},function(r,t){!function(t){"use strict";var n=t.FutoIn||{};if(void 0===n.Invoker){var o=e(10),i=o.SimpleCCM;t.SimpleCCM=i;var s=o.AdvancedCCM;t.AdvancedCCM=s,n.Invoker=o,t.FutoInInvoker=o,t.FutoIn=n,r&&(r.exports=o)}}(window)},function(r,t){"use strict";var n=e(26),o=e(9),i=o.FutoInError,s=WebSocket,a=o.Options.FUTOIN_CONTENT_TYPE;t.HTTPComms=function(){},t.HTTPComms.prototype={close:function(){},perform:function(r,e,t){var n=this;r.add(function(r){n._perform(r,e,t)})},_perform:function(r,e,t){e.signMessage(t);var n,o,s=e.options.messageSniffer,c=new XMLHttpRequest,u=e.endpoint,f=e.upload_data;if(f||""===f){n="application/octet-stream","/"!==u.charAt(u.length-1)&&(u+="/"),u+=t.f.replace(/:/g,"/")+"/","sec"in t&&(t.sec===e.options.credentials?o="Basic "+window.btoa(t.sec):u+=t.sec+"/");var p=[];for(var l in t.p){var v=t.p[l];"string"!=typeof v&&(v=JSON.stringify(v)),p.push(encodeURIComponent(l)+"="+encodeURIComponent(v))}u+="?"+p.join("&"),s(e.info,t,!1)}else n=a,f=JSON.stringify(t),s(e.info,f,!1);e.expect_response&&(e.download_stream&&(c.responseType=e.download_stream),c.onreadystatechange=function(){if(this.readyState===this.DONE){var t=e.download_stream?this.response:this.responseText;if(t){var n=this.getResponseHeader("content-type");n===a?s(e.info,t,!0):s(e.info,"%DATA%",!0),r.success(t,n)}else try{r.error(i.CommError,"Low error")}catch(r){}}},r.setCancel(function(){c.abort()})),c.open("POST",u,!0),c.setRequestHeader("Content-Type",n),o&&c.setRequestHeader("Authorization",o),c.send(f),e.expect_response||r.success()}},t.WSComms=function(){this.rid=1,this.reqas={},this.evt=n()},t.WSComms.prototype={_waiting_open:!1,init:function(r,e){var t=e.options,n=new s(e.endpoint);this.ws=n,this._waiting_open=!0;var o=this.reqas,a=t.executor||null,c=e.info,u=this,f=t.messageSniffer;this.sniffer=f;var p=function(r){var e=a.packPayloadJSON(r);f(c,e,!1),n.send(e)},l=function(r){t.disconnectSniffer(c),n.close(),delete u.ws;for(var s in o)try{o[s].error(i.CommError,r.wasClean?"Cleanup":"Error")}catch(r){}delete u.reqas,u.reqas={},u._waiting_open=!1,e.native_iface.emit("disconnect")};n.onclose=l,n.onerror=l,n.onopen=function(r){u._waiting_open=!1,u.evt.emit("open"),e.native_iface.emit("connect")},n.onmessage=function(r){f(c,r.data,!0);var e;try{e=JSON.parse(r.data)}catch(r){return}if("rid"in e){var t=e.rid;t in o?(o[t].success(e,!0),delete o[t]):"S"===t.charAt(0)&&a&&a.onEndpointRequest(c,e,p)}}},close:function(){this.ws&&this.ws.close()},perform:function(r,e,t){var n=this;"ws"in this||n.init(r,e),this._waiting_open&&r.add(function(r){if(n._waiting_open){var e=function(){r.success()};n.evt.once("open",e),r.setCancel(function(){n.evt.off("open",e)})}}),r.add(function(r){n._perform(r,e,t)})},_perform:function(r,e,t){"ws"in this||r.error(i.CommError,"Disconnect while in progress");var n=this.reqas,o="C"+this.rid++;t.rid=o,e.signMessage(t),e.expect_response&&(n[o]=r,r.setCancel(function(){delete n[o]}));var s=JSON.stringify(t);this.sniffer(e.info,s,!1),this.ws.send(s)}},s||(t.WSComms=t.HTTPComms),t.BrowserComms=function(){this.rid=1,this.reqas={}},t.BrowserComms.prototype={init:function(r,e){var t=e.options;this.opts=t;var n,o=e.endpoint.split("://",2)[1],s=window;"parent"===o?o=s.parent:o in s&&"postMessage"in s[o]?o=s[o]:(n=document.getElementById(o))?o=n.contentWindow:r.error(i.CommError,"Unknown target: "+o),o===s&&r.error(i.CommError,"Target matches current window"),this.target=o;var a=this.reqas,c=t.executor||null,u=e.info,f=t.targetOrigin,p=t.messageSniffer;this.sniffer=p;var l=function(r){p(f,r,!1),o.postMessage(r,f||"*")};s.addEventListener("message",function(r){if(p(u,r.data,!0),!r.source||r.source===o){if(f&&r.origin!==f)return console.log("Error: peer origin mismatch "),console.log("Error >origin: "+r.origin),void console.log("Error >required: "+f);var e=r.data;if("object"==typeof e){if("rid"in e){var t=e.rid;if(!("f"in e)&&t in a)a[t].success(e,!0),delete a[t];else{if(!("f"in e&&"S"===t.charAt(0)&&c))return;c.onEndpointRequest(u,e,l)}r.stopPropagation&&r.stopPropagation()}}else console.log("Not object response: "+e)}},!1),e.native_iface.emit("connect")},close:function(){this.target&&(this.target=null)},perform:function(r,e,t){(e.upload_data||e.download_stream)&&r.error(i.CommError,"Raw Data is not supported by Web Messaging yet"),this.target||this.init(r,e);var n=this;r.add(function(r){var o=n.reqas,i="C"+n.rid++;t.rid=i,e.signMessage(t),e.expect_response&&(o[i]=r,r.setCancel(function(r){delete o[i]})),n.sniffer(e.info,t,!1),n.target.postMessage(t,n.opts.targetOrigin||"*")})}}},function(r,t){"use strict";var n=e(27);t.AsyncSteps=n,t.FutoInError=n.FutoInError,t.Options={SAFE_PAYLOAD_LIMIT:65536,SVC_RESOLVER:"#resolver",SVC_AUTH:"#auth",SVC_DEFENSE:"#defense",SVC_ACL:"#acl",SVC_LOG:"#log",SVC_CACHE_:"#cache.",FUTOIN_CONTENT_TYPE:"application/futoin+json"},t._ifacever_pattern=/^(([a-z][a-z0-9]*)(\.[a-z][a-z0-9]*)*):(([0-9]+)\.([0-9]+))$/},function(r,t){"use strict";var n=e(9);t.SimpleCCM=e(3),t.AdvancedCCM=e(0),t.FutoInError=n.FutoInError,t.InterfaceInfo=e(1),t.NativeIface=e(2),t.SpecTools=e(4)},function(r,t){"use strict";var n=e(13),o=e(20),i=e(16),s=e(23);(r.exports=function(r,e){var t,i,a,c,u;return arguments.length<2||"string"!=typeof r?(c=e,e=r,r=null):c=arguments[2],null==r?(t=a=!0,i=!1):(t=s.call(r,"c"),i=s.call(r,"e"),a=s.call(r,"w")),u={value:e,configurable:t,enumerable:i,writable:a},c?n(o(c),u):u}).gs=function(r,e,t){var a,c,u,f;return"string"!=typeof r?(u=t,t=e,e=r,r=null):u=arguments[3],null==e?e=void 0:i(e)?null==t?t=void 0:i(t)||(u=t,t=void 0):(u=e,e=t=void 0),null==r?(a=!0,c=!1):(a=s.call(r,"c"),c=s.call(r,"e")),f={get:e,set:t,configurable:a,enumerable:c},u?n(o(u),f):f}},function(r,e){r.exports=!1;try{r.exports="[object process]"===Object.prototype.toString.call(t.process)}catch(r){}},function(r,t){"use strict";r.exports=e(14)()?Object.assign:e(15)},function(r,e){"use strict";r.exports=function(){var r,e=Object.assign;return"function"==typeof e&&(r={foo:"raz"},e(r,{bar:"dwa"},{trzy:"trzy"}),r.foo+r.bar+r.trzy==="razdwatrzy")}},function(r,t){"use strict";var n=e(17),o=e(22),i=Math.max;r.exports=function(r,e){var t,s,a,c=i(arguments.length,2);for(r=Object(o(r)),a=function(n){try{r[n]=e[n]}catch(r){t||(t=r)}},s=1;s<c;++s)e=arguments[s],n(e).forEach(a);if(void 0!==t)throw t;return r}},function(r,e){"use strict";r.exports=function(r){return"function"==typeof r}},function(r,t){"use strict";r.exports=e(18)()?Object.keys:e(19)},function(r,e){"use strict";r.exports=function(){try{return Object.keys("primitive"),!0}catch(r){return!1}}},function(r,e){"use strict";var t=Object.keys;r.exports=function(r){return t(null==r?r:Object(r))}},function(r,e){"use strict";var t=Array.prototype.forEach,n=Object.create,o=function(r,e){var t;for(t in r)e[t]=r[t]};r.exports=function(r){var e=n(null);return t.call(arguments,function(r){null!=r&&o(Object(r),e)}),e}},function(r,e){"use strict";r.exports=function(r){if("function"!=typeof r)throw new TypeError(r+" is not a function");return r}},function(r,e){"use strict";r.exports=function(r){if(null==r)throw new TypeError("Cannot use null or undefined");return r}},function(r,t){"use strict";r.exports=e(24)()?String.prototype.contains:e(25)},function(r,e){"use strict";var t="razdwatrzy";r.exports=function(){return"function"==typeof t.contains&&(!0===t.contains("dwa")&&!1===t.contains("foo"))}},function(r,e){"use strict";var t=String.prototype.indexOf;r.exports=function(r){return t.call(this,r,arguments[1])>-1}},function(r,t){"use strict";var n,o,i,s,a,c,u,f=e(11),p=e(21),l=Function.prototype.apply,v=Function.prototype.call,h=Object.create,_=Object.defineProperty,d=Object.defineProperties,m=Object.prototype.hasOwnProperty,y={configurable:!0,enumerable:!1,writable:!0};a={on:n=function(r,e){var t;return p(e),m.call(this,"__ee__")?t=this.__ee__:(t=y.value=h(null),_(this,"__ee__",y),y.value=null),t[r]?"object"==typeof t[r]?t[r].push(e):t[r]=[t[r],e]:t[r]=e,this},once:o=function(r,e){var t,o;return p(e),o=this,n.call(this,r,t=function(){i.call(o,r,t),l.call(e,this,arguments)}),t.__eeOnceListener__=e,this},off:i=function(r,e){var t,n,o,i;if(p(e),!m.call(this,"__ee__"))return this;if(!(t=this.__ee__)[r])return this;if("object"==typeof(n=t[r]))for(i=0;o=n[i];++i)o!==e&&o.__eeOnceListener__!==e||(2===n.length?t[r]=n[i?0:1]:n.splice(i,1));else n!==e&&n.__eeOnceListener__!==e||delete t[r];return this},emit:s=function(r){var e,t,n,o,i;if(m.call(this,"__ee__")&&(o=this.__ee__[r]))if("object"==typeof o){for(t=arguments.length,i=new Array(t-1),e=1;e<t;++e)i[e-1]=arguments[e];for(o=o.slice(),e=0;n=o[e];++e)l.call(n,this,i)}else switch(arguments.length){case 1:v.call(o,this);break;case 2:v.call(o,this,arguments[1]);break;case 3:v.call(o,this,arguments[1],arguments[2]);break;default:for(t=arguments.length,i=new Array(t-1),e=1;e<t;++e)i[e-1]=arguments[e];l.call(o,this,i)}}},c={on:f(n),once:f(o),off:f(i),emit:f(s)},u=d({},c),r.exports=t=function(r){return null==r?h(u):d(Object(r),c)},t.methods=a},function(e,t){e.exports=r},function(r,t){var n=e(96)(e(135),"DataView");r.exports=n},function(r,t){function n(r){var e=-1,t=null==r?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}var o=e(103),i=e(104),s=e(105),a=e(106),c=e(107);n.prototype.clear=o,n.prototype.delete=i,n.prototype.get=s,n.prototype.has=a,n.prototype.set=c,r.exports=n},function(r,t){function n(r){var e=-1,t=null==r?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}var o=e(117),i=e(118),s=e(119),a=e(120),c=e(121);n.prototype.clear=o,n.prototype.delete=i,n.prototype.get=s,n.prototype.has=a,n.prototype.set=c,r.exports=n},function(r,t){var n=e(96)(e(135),"Map");r.exports=n},function(r,t){function n(r){var e=-1,t=null==r?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}var o=e(122),i=e(123),s=e(124),a=e(125),c=e(126);n.prototype.clear=o,n.prototype.delete=i,n.prototype.get=s,n.prototype.has=a,n.prototype.set=c,r.exports=n},function(r,t){var n=e(96)(e(135),"Promise");r.exports=n},function(r,t){var n=e(96)(e(135),"Set");r.exports=n},function(r,t){function n(r){var e=-1,t=null==r?0:r.length;for(this.__data__=new o;++e<t;)this.add(r[e])}var o=e(32),i=e(136),s=e(137);n.prototype.add=n.prototype.push=i,n.prototype.has=s,r.exports=n},function(r,t){function n(r){var e=this.__data__=new o(r);this.size=e.size}var o=e(30),i=e(141),s=e(142),a=e(143),c=e(144),u=e(145);n.prototype.clear=i,n.prototype.delete=s,n.prototype.get=a,n.prototype.has=c,n.prototype.set=u,r.exports=n},function(r,t){var n=e(135).Symbol;r.exports=n},function(r,t){var n=e(135).Uint8Array;r.exports=n},function(r,t){var n=e(96)(e(135),"WeakMap");r.exports=n},function(r,e){r.exports=function(r,e){return r.set(e[0],e[1]),r}},function(r,e){r.exports=function(r,e){return r.add(e),r}},function(r,e){r.exports=function(r,e,t){switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2])}return r.apply(e,t)}},function(r,e){r.exports=function(r,e){for(var t=-1,n=null==r?0:r.length;++t<n&&!1!==e(r[t],t,r););return r}},function(r,e){r.exports=function(r,e){for(var t=-1,n=null==r?0:r.length,o=0,i=[];++t<n;){var s=r[t];e(s,t,r)&&(i[o++]=s)}return i}},function(r,t){var n=e(63);r.exports=function(r,e){return!!(null==r?0:r.length)&&n(r,e,0)>-1}},function(r,e){r.exports=function(r,e,t){for(var n=-1,o=null==r?0:r.length;++n<o;)if(t(e,r[n]))return!0;return!1}},function(r,t){var n=e(72),o=e(158),i=e(159),s=e(162),a=e(112),c=e(167),u=Object.prototype.hasOwnProperty;r.exports=function(r,e){var t=i(r),f=!t&&o(r),p=!t&&!f&&s(r),l=!t&&!f&&!p&&c(r),v=t||f||p||l,h=v?n(r.length,String):[],_=h.length;for(var d in r)!e&&!u.call(r,d)||v&&("length"==d||p&&("offset"==d||"parent"==d)||l&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||a(d,_))||h.push(d);return h}},function(r,e){r.exports=function(r,e){for(var t=-1,n=null==r?0:r.length,o=Array(n);++t<n;)o[t]=e(r[t],t,r);return o}},function(r,e){r.exports=function(r,e){for(var t=-1,n=e.length,o=r.length;++t<n;)r[o+t]=e[t];return r}},function(r,e){r.exports=function(r,e,t,n){var o=-1,i=null==r?0:r.length;for(n&&i&&(t=r[++o]);++o<i;)t=e(t,r[o],o,r);return t}},function(r,t){var n=e(55),o=e(155),i=Object.prototype.hasOwnProperty;r.exports=function(r,e,t){var s=r[e];i.call(r,e)&&o(s,t)&&(void 0!==t||e in r)||n(r,e,t)}},function(r,t){var n=e(155);r.exports=function(r,e){for(var t=r.length;t--;)if(n(r[t][0],e))return t;return-1}},function(r,t){var n=e(85),o=e(168);r.exports=function(r,e){return r&&n(e,o(e),r)}},function(r,t){var n=e(85),o=e(169);r.exports=function(r,e){return r&&n(e,o(e),r)}},function(r,t){var n=e(91);r.exports=function(r,e,t){"__proto__"==e&&n?n(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}},function(r,t){function n(r,e,t,T,M,P){var R,F=e&j,N=e&I,q=e&E;if(t&&(R=M?t(r,T,M,P):t(r)),void 0!==R)return R;if(!x(r))return r;var z=g(r);if(z){if(R=d(r),!F)return f(r,R)}else{var D=_(r),U=D==k||D==C;if(b(r))return u(r,F);if(D==A||D==O||U&&!M){if(R=N||U?{}:y(r),!F)return N?l(r,c(R,r)):p(r,a(R,r))}else{if(!S[D])return M?r:{};R=m(r,D,n,F)}}P||(P=new o);var H=P.get(r);if(H)return H;P.set(r,R);var B=q?N?h:v:N?keysIn:w,L=z?void 0:B(r);return i(L||r,function(o,i){L&&(o=r[i=o]),s(R,i,n(o,e,t,i,r,P))}),R}var o=e(36),i=e(43),s=e(51),a=e(53),c=e(54),u=e(77),f=e(84),p=e(86),l=e(87),v=e(93),h=e(94),_=e(101),d=e(108),m=e(109),y=e(110),g=e(159),b=e(162),x=e(165),w=e(168),j=1,I=2,E=4,O="[object Arguments]",k="[object Function]",C="[object GeneratorFunction]",A="[object Object]",S={};S[O]=S["[object Array]"]=S["[object ArrayBuffer]"]=S["[object DataView]"]=S["[object Boolean]"]=S["[object Date]"]=S["[object Float32Array]"]=S["[object Float64Array]"]=S["[object Int8Array]"]=S["[object Int16Array]"]=S["[object Int32Array]"]=S["[object Map]"]=S["[object Number]"]=S[A]=S["[object RegExp]"]=S["[object Set]"]=S["[object String]"]=S["[object Symbol]"]=S["[object Uint8Array]"]=S["[object Uint8ClampedArray]"]=S["[object Uint16Array]"]=S["[object Uint32Array]"]=!0,S["[object Error]"]=S[k]=S["[object WeakMap]"]=!1,r.exports=n},function(r,t){var n=e(165),o=Object.create,i=function(){function r(){}return function(e){if(!n(e))return{};if(o)return o(e);r.prototype=e;var t=new r;return r.prototype=void 0,t}}();r.exports=i},function(r,t){var n=e(35),o=e(45),i=e(46),s=e(48),a=e(73),c=e(75),u=200;r.exports=function(r,e,t,f){var p=-1,l=o,v=!0,h=r.length,_=[],d=e.length;if(!h)return _;t&&(e=s(e,a(t))),f?(l=i,v=!1):e.length>=u&&(l=c,v=!1,e=new n(e));r:for(;++p<h;){var m=r[p],y=null==t?m:t(m);if(m=f||0!==m?m:0,v&&y===y){for(var g=d;g--;)if(e[g]===y)continue r;_.push(m)}else l(e,y,f)||_.push(m)}return _}},function(r,e){r.exports=function(r,e,t,n){for(var o=r.length,i=t+(n?1:-1);n?i--:++i<o;)if(e(r[i],i,r))return i;return-1}},function(r,t){function n(r,e,t,s,a){var c=-1,u=r.length;for(t||(t=i),a||(a=[]);++c<u;){var f=r[c];e>0&&t(f)?e>1?n(f,e-1,t,s,a):o(a,f):s||(a[a.length]=f)}return a}var o=e(49),i=e(111);r.exports=n},function(r,t){var n=e(49),o=e(159);r.exports=function(r,e,t){var i=e(r);return o(r)?i:n(i,t(r))}},function(r,t){var n=e(37),o=e(98),i=e(132),s="[object Null]",a="[object Undefined]",c=n?n.toStringTag:void 0;r.exports=function(r){return null==r?void 0===r?a:s:c&&c in Object(r)?o(r):i(r)}},function(r,t){var n=e(59),o=e(65),i=e(146);r.exports=function(r,e,t){return e===e?i(r,e,t):n(r,o,t)}},function(r,t){var n=e(62),o=e(166),i="[object Arguments]";r.exports=function(r){return o(r)&&n(r)==i}},function(r,e){r.exports=function(r){return r!==r}},function(r,t){var n=e(163),o=e(115),i=e(165),s=e(147),a=/[\\^$.*+?()[\]{}|]/g,c=/^\[object .+?Constructor\]$/,u=Function.prototype,f=Object.prototype,p=u.toString,l=f.hasOwnProperty,v=RegExp("^"+p.call(l).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");r.exports=function(r){return!(!i(r)||o(r))&&(n(r)?v:c).test(s(r))}},function(r,t){var n=e(62),o=e(164),i=e(166),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,r.exports=function(r){return i(r)&&o(r.length)&&!!s[n(r)]}},function(r,t){var n=e(116),o=e(129),i=Object.prototype.hasOwnProperty;r.exports=function(r){if(!n(r))return o(r);var e=[];for(var t in Object(r))i.call(r,t)&&"constructor"!=t&&e.push(t);return e}},function(r,t){var n=e(165),o=e(116),i=e(130),s=Object.prototype.hasOwnProperty;r.exports=function(r){if(!n(r))return i(r);var e=o(r),t=[];for(var a in r)("constructor"!=a||!e&&s.call(r,a))&&t.push(a);return t}},function(r,t){var n=e(157),o=e(134),i=e(139);r.exports=function(r,e){return i(o(r,e,n),r+"")}},function(r,t){var n=e(152),o=e(91),i=e(157),s=o?function(r,e){return o(r,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:i;r.exports=s},function(r,e){r.exports=function(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}},function(r,e){r.exports=function(r){return function(e){return r(e)}}},function(r,e){r.exports=function(r,e,t){for(var n=-1,o=r.length,i=e.length,s={};++n<o;){var a=n<i?e[n]:void 0;t(s,r[n],a)}return s}},function(r,e){r.exports=function(r,e){return r.has(e)}},function(r,t){var n=e(38);r.exports=function(r){var e=new r.constructor(r.byteLength);return new n(e).set(new n(r)),e}},function(r,t){var n=e(135),o="object"==typeof t&&t&&!t.nodeType&&t,i=o&&"object"==typeof r&&r&&!r.nodeType&&r,s=i&&i.exports===o?n.Buffer:void 0,a=s?s.allocUnsafe:void 0;r.exports=function(r,e){if(e)return r.slice();var t=r.length,n=a?a(t):new r.constructor(t);return r.copy(n),n}},function(r,t){var n=e(76);r.exports=function(r,e){var t=e?n(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.byteLength)}},function(r,t){var n=e(40),o=e(50),i=e(127),s=1;r.exports=function(r,e,t){var a=e?t(i(r),s):i(r);return o(a,n,new r.constructor)}},function(r,e){var t=/\w*$/;r.exports=function(r){var e=new r.constructor(r.source,t.exec(r));return e.lastIndex=r.lastIndex,e}},function(r,t){var n=e(41),o=e(50),i=e(138),s=1;r.exports=function(r,e,t){var a=e?t(i(r),s):i(r);return o(a,n,new r.constructor)}},function(r,t){var n=e(37),o=n?n.prototype:void 0,i=o?o.valueOf:void 0;r.exports=function(r){return i?Object(i.call(r)):{}}},function(r,t){var n=e(76);r.exports=function(r,e){var t=e?n(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.length)}},function(r,e){r.exports=function(r,e){var t=-1,n=r.length;for(e||(e=Array(n));++t<n;)e[t]=r[t];return e}},function(r,t){var n=e(51),o=e(55);r.exports=function(r,e,t,i){var s=!t;t||(t={});for(var a=-1,c=e.length;++a<c;){var u=e[a],f=i?i(t[u],r[u],u,t,r):void 0;void 0===f&&(f=r[u]),s?o(t,u,f):n(t,u,f)}return t}},function(r,t){var n=e(85),o=e(99);r.exports=function(r,e){return n(r,o(r),e)}},function(r,t){var n=e(85),o=e(100);r.exports=function(r,e){return n(r,o(r),e)}},function(r,t){var n=e(135)["__core-js_shared__"];r.exports=n},function(r,t){var n=e(70),o=e(113);r.exports=function(r){return n(function(e,t){var n=-1,i=t.length,s=i>1?t[i-1]:void 0,a=i>2?t[2]:void 0;for(s=r.length>3&&"function"==typeof s?(i--,s):void 0,a&&o(t[0],t[1],a)&&(s=i<3?void 0:s,i=1),e=Object(e);++n<i;){var c=t[n];c&&r(e,c,n,s)}return e})}},function(r,t){var n=e(155),o=Object.prototype,i=o.hasOwnProperty;r.exports=function(r,e,t,s){return void 0===r||n(r,o[t])&&!i.call(s,t)?e:r}},function(r,t){var n=e(96),o=function(){try{var r=n(Object,"defineProperty");return r({},"",{}),r}catch(r){}}();r.exports=o},function(r,e){var n="object"==typeof t&&t&&t.Object===Object&&t;r.exports=n},function(r,t){var n=e(61),o=e(99),i=e(168);r.exports=function(r){return n(r,i,o)}},function(r,t){var n=e(61),o=e(100),i=e(169);r.exports=function(r){return n(r,i,o)}},function(r,t){var n=e(114);r.exports=function(r,e){var t=r.__data__;return n(e)?t["string"==typeof e?"string":"hash"]:t.map}},function(r,t){var n=e(66),o=e(102);r.exports=function(r,e){var t=o(r,e);return n(t)?t:void 0}},function(r,t){var n=e(133)(Object.getPrototypeOf,Object);r.exports=n},function(r,t){var n=e(37),o=Object.prototype,i=o.hasOwnProperty,s=o.toString,a=n?n.toStringTag:void 0;r.exports=function(r){var e=i.call(r,a),t=r[a];try{r[a]=void 0;var n=!0}catch(r){}var o=s.call(r);return n&&(e?r[a]=t:delete r[a]),o}},function(r,t){var n=e(44),o=e(170),i=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(r){return null==r?[]:(r=Object(r),n(s(r),function(e){return i.call(r,e)}))}:o;r.exports=a},function(r,t){var n=e(49),o=e(97),i=e(99),s=e(170),a=Object.getOwnPropertySymbols?function(r){for(var e=[];r;)n(e,i(r)),r=o(r);return e}:s;r.exports=a},function(r,t){var n=e(28),o=e(31),i=e(33),s=e(34),a=e(39),c=e(62),u=e(147),f=u(n),p=u(o),l=u(i),v=u(s),h=u(a),_=c;(n&&"[object DataView]"!=_(new n(new ArrayBuffer(1)))||o&&"[object Map]"!=_(new o)||i&&"[object Promise]"!=_(i.resolve())||s&&"[object Set]"!=_(new s)||a&&"[object WeakMap]"!=_(new a))&&(_=function(r){var e=c(r),t="[object Object]"==e?r.constructor:void 0,n=t?u(t):"";if(n)switch(n){case f:return"[object DataView]";case p:return"[object Map]";case l:return"[object Promise]";case v:return"[object Set]";case h:return"[object WeakMap]"}return e}),r.exports=_},function(r,e){r.exports=function(r,e){return null==r?void 0:r[e]}},function(r,t){var n=e(128);r.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(r,e){r.exports=function(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}},function(r,t){var n=e(128),o="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;r.exports=function(r){var e=this.__data__;if(n){var t=e[r];return t===o?void 0:t}return i.call(e,r)?e[r]:void 0}},function(r,t){var n=e(128),o=Object.prototype.hasOwnProperty;r.exports=function(r){var e=this.__data__;return n?void 0!==e[r]:o.call(e,r)}},function(r,t){var n=e(128),o="__lodash_hash_undefined__";r.exports=function(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=n&&void 0===e?o:e,this}},function(r,e){var t=Object.prototype.hasOwnProperty;r.exports=function(r){var e=r.length,n=r.constructor(e);return e&&"string"==typeof r[0]&&t.call(r,"index")&&(n.index=r.index,n.input=r.input),n}},function(r,t){var n=e(76),o=e(78),i=e(79),s=e(80),a=e(81),c=e(82),u=e(83),f="[object Boolean]",p="[object Date]",l="[object Map]",v="[object Number]",h="[object RegExp]",_="[object Set]",d="[object String]",m="[object Symbol]",y="[object ArrayBuffer]",g="[object DataView]",b="[object Float32Array]",x="[object Float64Array]",w="[object Int8Array]",j="[object Int16Array]",I="[object Int32Array]",E="[object Uint8Array]",O="[object Uint8ClampedArray]",k="[object Uint16Array]",C="[object Uint32Array]";r.exports=function(r,e,t,A){var S=r.constructor;switch(e){case y:return n(r);case f:case p:return new S(+r);case g:return o(r,A);case b:case x:case w:case j:case I:case E:case O:case k:case C:return u(r,A);case l:return i(r,A,t);case v:case d:return new S(r);case h:return s(r);case _:return a(r,A,t);case m:return c(r)}}},function(r,t){var n=e(57),o=e(97),i=e(116);r.exports=function(r){return"function"!=typeof r.constructor||i(r)?{}:n(o(r))}},function(r,t){var n=e(37),o=e(158),i=e(159),s=n?n.isConcatSpreadable:void 0;r.exports=function(r){return i(r)||o(r)||!!(s&&r&&r[s])}},function(r,e){var t=9007199254740991,n=/^(?:0|[1-9]\d*)$/;r.exports=function(r,e){return!!(e=null==e?t:e)&&("number"==typeof r||n.test(r))&&r>-1&&r%1==0&&r<e}},function(r,t){var n=e(155),o=e(160),i=e(112),s=e(165);r.exports=function(r,e,t){if(!s(t))return!1;var a=typeof e;return!!("number"==a?o(t)&&i(e,t.length):"string"==a&&e in t)&&n(t[e],r)}},function(r,e){r.exports=function(r){var e=typeof r;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==r:null===r}},function(r,t){var n=e(88),o=function(){var r=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();r.exports=function(r){return!!o&&o in r}},function(r,e){var t=Object.prototype;r.exports=function(r){var e=r&&r.constructor;return r===("function"==typeof e&&e.prototype||t)}},function(r,e){r.exports=function(){this.__data__=[],this.size=0}},function(r,t){var n=e(52),o=Array.prototype.splice;r.exports=function(r){var e=this.__data__,t=n(e,r);return!(t<0||(t==e.length-1?e.pop():o.call(e,t,1),--this.size,0))}},function(r,t){var n=e(52);r.exports=function(r){var e=this.__data__,t=n(e,r);return t<0?void 0:e[t][1]}},function(r,t){var n=e(52);r.exports=function(r){return n(this.__data__,r)>-1}},function(r,t){var n=e(52);r.exports=function(r,e){var t=this.__data__,o=n(t,r);return o<0?(++this.size,t.push([r,e])):t[o][1]=e,this}},function(r,t){var n=e(29),o=e(30),i=e(31);r.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||o),string:new n}}},function(r,t){var n=e(95);r.exports=function(r){var e=n(this,r).delete(r);return this.size-=e?1:0,e}},function(r,t){var n=e(95);r.exports=function(r){return n(this,r).get(r)}},function(r,t){var n=e(95);r.exports=function(r){return n(this,r).has(r)}},function(r,t){var n=e(95);r.exports=function(r,e){var t=n(this,r),o=t.size;return t.set(r,e),this.size+=t.size==o?0:1,this}},function(r,e){r.exports=function(r){var e=-1,t=Array(r.size);return r.forEach(function(r,n){t[++e]=[n,r]}),t}},function(r,t){var n=e(96)(Object,"create");r.exports=n},function(r,t){var n=e(133)(Object.keys,Object);r.exports=n},function(r,e){r.exports=function(r){var e=[];if(null!=r)for(var t in Object(r))e.push(t);return e}},function(r,t){var n=e(92),o="object"==typeof t&&t&&!t.nodeType&&t,i=o&&"object"==typeof r&&r&&!r.nodeType&&r,s=i&&i.exports===o&&n.process,a=function(){try{return s&&s.binding&&s.binding("util")}catch(r){}}();r.exports=a},function(r,e){var t=Object.prototype.toString;r.exports=function(r){return t.call(r)}},function(r,e){r.exports=function(r,e){return function(t){return r(e(t))}}},function(r,t){var n=e(42),o=Math.max;r.exports=function(r,e,t){return e=o(void 0===e?r.length-1:e,0),function(){for(var i=arguments,s=-1,a=o(i.length-e,0),c=Array(a);++s<a;)c[s]=i[e+s];s=-1;for(var u=Array(e+1);++s<e;)u[s]=i[s];return u[e]=t(c),n(r,this,u)}}},function(r,t){var n=e(92),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();r.exports=i},function(r,e){var t="__lodash_hash_undefined__";r.exports=function(r){return this.__data__.set(r,t),this}},function(r,e){r.exports=function(r){return this.__data__.has(r)}},function(r,e){r.exports=function(r){var e=-1,t=Array(r.size);return r.forEach(function(r){t[++e]=r}),t}},function(r,t){var n=e(71),o=e(140)(n);r.exports=o},function(r,e){var t=800,n=16,o=Date.now;r.exports=function(r){var e=0,i=0;return function(){var s=o(),a=n-(s-i);if(i=s,a>0){if(++e>=t)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}},function(r,t){var n=e(30);r.exports=function(){this.__data__=new n,this.size=0}},function(r,e){r.exports=function(r){var e=this.__data__,t=e.delete(r);return this.size=e.size,t}},function(r,e){r.exports=function(r){return this.__data__.get(r)}},function(r,e){r.exports=function(r){return this.__data__.has(r)}},function(r,t){var n=e(30),o=e(31),i=e(32),s=200;r.exports=function(r,e){var t=this.__data__;if(t instanceof n){var a=t.__data__;if(!o||a.length<s-1)return a.push([r,e]),this.size=++t.size,this;t=this.__data__=new i(a)}return t.set(r,e),this.size=t.size,this}},function(r,e){r.exports=function(r,e,t){for(var n=t-1,o=r.length;++n<o;)if(r[n]===e)return n;return-1}},function(r,e){var t=Function.prototype.toString;r.exports=function(r){if(null!=r){try{return t.call(r)}catch(r){}try{return r+""}catch(r){}}return""}},function(r,t){var n=e(85),o=e(89),i=e(169),s=o(function(r,e){n(e,i(e),r)});r.exports=s},function(r,t){var n=e(85),o=e(89),i=e(169),s=o(function(r,e,t,o){n(e,i(e),r,o)});r.exports=s},function(r,t){var n=e(56),o=4;r.exports=function(r){return n(r,o)}},function(r,t){var n=e(56),o=1,i=4;r.exports=function(r){return n(r,o|i)}},function(r,e){r.exports=function(r){return function(){return r}}},function(r,t){var n=e(42),o=e(149),i=e(70),s=e(90),a=i(function(r){return r.push(void 0,s),n(o,void 0,r)});r.exports=a},function(r,t){var n=e(58),o=e(60),i=e(70),s=e(161),a=i(function(r,e){return s(r)?n(r,o(e,1,s,!0)):[]});r.exports=a},function(r,e){r.exports=function(r,e){return r===e||r!==r&&e!==e}},function(r,t){r.exports=e(148)},function(r,e){r.exports=function(r){return r}},function(r,t){var n=e(64),o=e(166),i=Object.prototype,s=i.hasOwnProperty,a=i.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(r){return o(r)&&s.call(r,"callee")&&!a.call(r,"callee")};r.exports=c},function(r,e){var t=Array.isArray;r.exports=t},function(r,t){var n=e(163),o=e(164);r.exports=function(r){return null!=r&&o(r.length)&&!n(r)}},function(r,t){var n=e(160),o=e(166);r.exports=function(r){return o(r)&&n(r)}},function(r,t){var n=e(135),o=e(171),i="object"==typeof t&&t&&!t.nodeType&&t,s=i&&"object"==typeof r&&r&&!r.nodeType&&r,a=s&&s.exports===i?n.Buffer:void 0,c=(a?a.isBuffer:void 0)||o;r.exports=c},function(r,t){var n=e(62),o=e(165),i="[object AsyncFunction]",s="[object Function]",a="[object GeneratorFunction]",c="[object Proxy]";r.exports=function(r){if(!o(r))return!1;var e=n(r);return e==s||e==a||e==i||e==c}},function(r,e){var t=9007199254740991;r.exports=function(r){return"number"==typeof r&&r>-1&&r%1==0&&r<=t}},function(r,e){r.exports=function(r){var e=typeof r;return null!=r&&("object"==e||"function"==e)}},function(r,e){r.exports=function(r){return null!=r&&"object"==typeof r}},function(r,t){var n=e(67),o=e(73),i=e(131),s=i&&i.isTypedArray,a=s?o(s):n;r.exports=a},function(r,t){var n=e(47),o=e(68),i=e(160);r.exports=function(r){return i(r)?n(r):o(r)}},function(r,t){var n=e(47),o=e(69),i=e(160);r.exports=function(r){return i(r)?n(r,!0):o(r)}},function(r,e){r.exports=function(){return[]}},function(r,e){r.exports=function(){return!1}},function(r,t){var n=e(51),o=e(74);r.exports=function(r,e){return o(r||[],e||[],n)}}],e(7)});